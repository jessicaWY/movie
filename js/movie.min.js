var app=angular.module("kaifanla",["ng","ngRoute"]);app.controller("parentCtrl",function(a,b){a.jump=function(c){b.path(c)}});app.controller("mainCtrl",function(a,b){a.hasMore=true;b.get("data/dish_getbypage.php?start=0").success(function(c){a.dishList=c});a.loadMore=function(){b.get("data/dish_getbypage.php?start="+a.dishList.length).success(function(c){if(c.length<5){a.hasMore=false}a.dishList=a.dishList.concat(c)})};a.$watch("kw",function(){console.log(a.kw);if(a.kw){b.get("data/dish_getbykw.php?kw="+a.kw).success(function(c){console.log(c);a.dishList=c})}})});app.controller("detailCtrl",function(a,c,b){console.log(b.did);c.get("data/dish_getbyid.php?id="+b.did).success(function(d){a.dish=d;a.dish.did=b.did})});app.controller("orderCtrl",function(b,d,c,a){console.log(c.did);b.submitOrder=function(){b.user.did=c.did;var e=jQuery.param(b.user);console.log(e);d.get("data/order_add.php?"+e).success(function(f){console.log(f);if(f.msg=="succ"){b.msgSuccess="订餐成功!您的订单编号为:"+f.did+"。您可以在用户中心查看订单状态";a.phone=b.user.phone}else{b.msgError="订餐失败!失败"+f.reason}})}});app.controller("myorderCtrl",function(b,c,a){c.get("data/order_getbyphone.php?phone="+a.phone).success(function(d){console.log(d);b.orderList=d})});app.config(function(a){a.when("/start",{templateUrl:"tpl/start.html"}).when("/main",{templateUrl:"tpl/main.html",controller:"mainCtrl"}).when("/detail",{templateUrl:"tpl/detail.html",controller:"detailCtrl"}).when("/detail/:did",{templateUrl:"tpl/detail.html",controller:"detailCtrl"}).when("/order",{templateUrl:"tpl/order.html",controller:"orderCtrl"}).when("/order/:did",{templateUrl:"tpl/order.html",controller:"orderCtrl"}).when("/myorder",{templateUrl:"tpl/myorder.html",controller:"myorderCtrl"}).otherwise({redirectTo:"start"})});